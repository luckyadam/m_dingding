PP.define("dialog",function(t){"use strict";var n=t("overlay"),i=_.Class.extend({construct:function(t){this.conf=$.extend({text:"",onClick:function(){},isDefault:!1,isDisabled:!1,destroyOnClick:!0},t);var n=this.conf;this.$content=$('<button class="dialog_btn"></button>').addClass({"true":"default"}[n.isDefault]),this.setText(n.text),n.isDisabled&&this.disable(),"function"==typeof n.onClick&&this.$content.on("click",$.proxy(function(){n.destroyOnClick&&this.unbind(),n.onClick()},this))},getDom:function(){return this.$content},disable:function(){return this.$content.attr("disabled","disabled"),this},enable:function(){return this.$content.removeAttr("disabled"),this},setText:function(t){return"string"==typeof t&&(t.length?this.$content.text(t):this.$content.text("")),this},unbind:function(){return this.$content.off(),this}}),e=_.Class.extend({construct:function(t){this.conf=$.extend({title:"",message:"",content:"",mask:!0,modal:!0},t);var i=this.conf;this.$dialogContainer=$('<div class="dialog"></div>'),this.$dialogTitle=$('<div class="dialog_title"></div>'),this.$dialogMessage=$('<div class="dialog_message"></div>'),this.$dialogContent=$('<div class="dialog_content"></div>').append(i.content),this.$dialogBtnContainer=$('<div class="dialog_btn_container"></div>'),i.title&&(this.$dialogContainer.append(this.$dialogTitle),this.setTitle(i.title)),i.message&&(this.$dialogContainer.append(this.$dialogMessage),this.setTitle(i.message)),this.$dialogContainer.append(this.$dialogContent);var e=this.$dialogContainer;this.btns=[],this.overlay=new n({content:e,mask:i.mask,modal:i.modal})},show:function(){return this.overlay.show(),this},hide:function(){return this.overlay.hide(),this},addBtn:function(t){var n=t.onClick,e=this;t=$.extend({destroyOnClick:!0},t),t.destroyOnClick&&(t.onClick=function(){"function"==typeof n&&n(),e.destroy()});var s=new i(t);return this.$dialogContainer.find(".dialog_btn_container").length||this.$dialogContainer.append(this.$dialogBtnContainer),this.$dialogBtnContainer.append(s.getDom()),this.btns.push(s),this},destroy:function(){return this.off(),this.overlay.destroy(),this},on:function(){return $.fn.on.apply(this.$dialogContainer,arguments),this},off:function(){return $.fn.off.apply(this.$dialogContainer,arguments),this},setTitle:function(t){return"string"==typeof t&&t.length?this.$dialogTitle.show().html(t):this.$dialogTitle.hide(),this},setMessage:function(t){return"string"==typeof t&&t.length?this.$dialogMessage.show().html(t):this.$dialogMessage.hide(),this},content:function(t){return void 0===t?this.$dialogContent.html():(this.$dialogContent.html(t),this)}});return e}),PP.define("alert",function(t){"use strict";var n=t("dialog"),i=_.Class.extend({construct:function(t){"string"==typeof t&&(t={title:t}),this.conf=$.extend({title:"",message:"",okBtnText:"确定",onOk:function(){}},t);var i=this.conf,e=new n({title:i.title,message:i.message});e.addBtn({text:i.okBtnText,onClick:i.onOk})}});return i}),PP.define("confirm",function(t){"use strict";var n=t("dialog"),i=_.Class.extend({construct:function(t){"string"==typeof t&&(t={title:t}),this.conf=$.extend({title:"",message:"",okBtnText:"确定",cancelBtnText:"取消",onOk:function(){},onCancel:function(){}},t);var i=this.conf,e=new n({title:i.title,message:i.message});e.addBtn({text:i.cancelBtnText,onClick:i.onCancel}).addBtn({text:i.okBtnText,isDefault:!0,onClick:i.onOk})}});return i}),PP.define("overlay",function(){"use strict";var t=_.Class.extend({statics:{BEFORE_FADE_IN:0,ONSHOW:1,AFTER_FADE_OUT:2},construct:function(n){this.conf=$.extend({content:"",mask:!0,modal:!0},n),this.$overlayContainer=$('<div class="overlay_container before_fade_in"></div>'),this.$overlayContentContainer=$('<div class="overlay_content_container"></div>'),this.$overlayContent=$('<div class="overlay_content"></div>');var i=this.conf;this.$overlayContainer.on("webkitTransitionEnd.overlay",$.proxy(function(){this.status===t.AFTER_FADE_OUT&&(this.status=t.BEFORE_FADE_IN,this.$overlayContainer.hide().removeClass("after_fade_out").addClass("before_fade_in"))},this)),i.mask?this.$overlayContainer.on("touchmove",function(t){t.preventDefault()}):this.$overlayContainer.addClass("unmask"),i.modal||this.$overlayContainer.on("touchend",$.proxy(function(t){var n=$(t.target);n.is(".overlay_content")||this.destroy()},this)),this.content(i.content),this.$overlayContainer.append(this.$overlayContentContainer.append(this.$overlayContent)).appendTo($("body")),this.status=t.BEFORE_FADE_IN,this.show()},show:function(){return this.status=t.ONSHOW,this.$overlayContainer.show().removeClass("before_fade_in"),this},hide:function(){return this.status===t.ONSHOW?(this.status=t.AFTER_FADE_OUT,this.$overlayContainer.addClass("after_fade_out")):this.status=t.BEFORE_FADE_IN,this},on:function(){return $.fn.on.apply(this.$overlayContent,arguments),this},off:function(){return $.fn.off.apply(this.$overlayContent,arguments),this},destroy:function(){this.off(),this.status!==t.ONSHOW?this.$overlayContainer.remove():(this.hide(),this.$overlayContainer.off("webkitTransitionEnd.overlay").on("webkitTransitionEnd",$.proxy(function(){this.$overlayContainer.off("webkitTransitionEnd").remove()},this)))},content:function(t){return void 0===t?this.$overlayContent.children():(this.$overlayContent.html(t),this)}});return t}),PP.define("tab",function(){"use strict";var t=_.Class.extend({construct:function(t){this.conf=$.extend({container:null,head:null,content:null,startAt:0,hash:!1,onBeforeSwitch:function(){},onAfterSwitch:function(){},onFirstShow:function(){}},t),this.index=void 0;var n=this.conf;this.$el=$(n.container),this.$head=n.head?$(n.head):this.$el.children(".tab_head, .j_tab_head"),this.$headItems=this.$head.children(".tab_head_item, .j_tab_head_item"),this.$content=n.content?$(n.content):this.$el.children(".tab_content, .j_tab_content"),this.$contentItems=this.$content.children(".tab_content_item, .j_tab_content_item"),this.tabLength=this.$headItems.length;for(var i=0,e=this.$headItems.length;e>i;i++)this.$headItems[i].hasShown=!1;this.init()},init:function(){var t=this.conf,n=-1,i=window.location.hash;t.hash&&i.length>1?this.switchTo(i):("string"==typeof t.startAt?(this.$active=this.$headItems.filter(t.startAt),n=this.$active.length?this.$active.index():0):n="number"==typeof t.startAt?t.startAt:0,this.switchTo(n)),this.initEvent()},initEvent:function(){var t=this;t.conf;this.$head.on("click",".tab_head_item, .j_tab_head_item",function(){var n=$(this).index();return t.switchTo(n),!1})},switchTo:function(t){var n=this.conf;if(n.hash){var i;if("string"==typeof t&&(i=t.replace("#",""),this.$active=this.$headItems.filter("[data-hash$="+i+"]"),t=this.$active.index()),"number"==typeof t&&(i=this.$headItems.eq(t).attr("data-hash")),-1===t)return-1;window.location.hash=i}return t=parseInt(t,10),t!==this.index?(this.index=t,"function"==typeof n.onBeforeSwitch&&n.onBeforeSwitch.call(this,t,this),this.$headItems.removeClass("active").eq(t).addClass("active"),this.$contentItems.hide().eq(t).show(),"function"==typeof n.onAfterSwitch&&n.onAfterSwitch.call(this,t,this),this.$headItems[t].hasShown||"function"!=typeof n.onFirstShow||(n.onFirstShow.call(this,t,this),this.$headItems[t].hasShown=!0),this):void 0},switchToNext:function(){var t=this.index+1;return t>=this.tabLength&&(t=0),this.switchTo(t),this},switchToPrev:function(){var t=this.index+1;return 0>=t&&(t=0),this.switchTo(t),this},destroy:function(){this.unbind(),this.$el.remove()},unbind:function(){return this.$head.off(),this},setOptions:function(t){return $.extend(this.conf,t),this}});return t});